- hosts:                  localhost
  vars:
    ansible_user:         "admin"
    ansible_host:         "{{ lookup('device42.d42.d42', 'SELECT * FROM view_device_v1', 'doql', 'string') }}"
    ansible_ssh_pass:     "{{ lookup('device42.d42.d42', '{{inventory_hostname}}', 'password', '{{ansible_user}}') }}"
    device_details:
      name:               "{{ item.name }}"
      type:               "{{ item.type_id }}"
      service_level:      "{{ item.service_level }}"
      serial_no:          "{{ item.serial_no }}"
      cpupower:           "{{ item.cpupower }}"
      ram:                "{{ item.ram }}"
      notes:              "{{ item.notes }}"
  tasks:
    - shell:              echo "{{item}}"
      with_items:         "{{ lookup('device42.d42.d42', 'SELECT * FROM view_device_v1', 'doql', 'list_dicts') }}"
